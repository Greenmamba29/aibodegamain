import React, { useState, useEffect, createContext, useContext, ReactNode } from 'react';

// Create a context for the translation
const TranslationContext = createContext<{
  language: string;
  t: (key: string) => string;
  setLanguage: (lang: string) => void;
}>({
  language: 'en',
  t: (key: string) => key,
  setLanguage: () => {},
});

// Sample translations for demonstration
const translations: Record<string, Record<string, string>> = {
  en: {
    'welcome': 'AI App Store',
    'featured_apps': 'Featured Apps',
    'discover': 'Discover AI Apps',
    'categories': 'Browse by Category',
    'collections': 'Curated Collections',
    'sign_in': 'Sign In',
    'sign_up': 'Sign Up',
    'profile': 'Profile',
    'settings': 'Settings',
    'developer': 'Developer',
    'consumer': 'Consumer',
    'admin': 'Admin',
    'search': 'Search',
    'followers': 'followers',
    'following': 'following',
    'submit_app': 'Submit App',
    'manage_apps': 'Manage Apps',
    'analytics': 'Analytics',
    'revenue': 'Revenue',
    'logout': 'Sign Out',
    'ai_tools': 'AI Tools',
    'explore_apps': 'Explore Apps',
    'watch_demo': 'Watch Demo',
    'try_free': 'Try Free',
    'buy': 'Buy',
    'open_app': 'Open App',
    'view_all': 'View All Apps',
    'view_collection': 'View Collection',
    'browse_all': 'Browse All Collections',
    'explore': 'Explore',
    'applications': 'applications',
    'discover_description': 'Explore the latest AI applications tailored for you',
    'featured_description': 'Handpicked AI applications that are making waves',
    'clear_filter': 'Clear Filter',
    'filtered_by': 'Filtered by',
    'app_store_description': 'Discover, share, and monetize cutting-edge AI applications. The premier marketplace for indie AI developers and enthusiasts.',
    'category_description': 'Find AI apps tailored to your specific needs',
    'collection_description': 'Handpicked app collections for specific use cases',
    'contact_support': 'Contact Support',
    'purchase_history': 'Purchase History',
    'upgrade_plan': 'Upgrade Plan',
    'manage_subscription': 'Manage Subscription',
    'become_developer': 'Become a Developer',
    'switch_to': 'Switch to',
    'view_profile': 'View Profile',
    'search_placeholder': 'Search AI apps, developers, or categories...',
    'active_users': 'Active Users',
    'ai_apps': 'AI Apps',
    'categories_count': 'Categories',
    'trusted_by': 'Trusted by developers worldwide',
    'platform': 'Platform',
    'browse_apps': 'Browse Apps',
    'featured': 'Featured',
    'new_releases': 'New Releases',
    'developers': 'Developers',
    'developer_portal': 'Developer Portal',
    'api_docs': 'API Documentation',
    'guidelines': 'Guidelines',
    'all_rights_reserved': 'All rights reserved.',
    'made_with': 'Made with',
    'by_indie_devs': 'by indie developers',
    'no_account': "Don't have an account?",
    'have_account': "Already have an account?",
    'terms_agreement': 'By creating an account, you agree to our Terms of Service and Privacy Policy.',
    'owned': 'Owned',
    'free': 'Free',
    'freemium': 'Freemium',
  },
  es: {
    'welcome': 'Tienda de Aplicaciones IA',
    'featured_apps': 'Aplicaciones Destacadas',
    'discover': 'Descubre Aplicaciones de IA',
    'categories': 'Explorar por Categoría',
    'collections': 'Colecciones Seleccionadas',
    'sign_in': 'Iniciar Sesión',
    'sign_up': 'Registrarse',
    'profile': 'Perfil',
    'settings': 'Configuración',
    'developer': 'Desarrollador',
    'consumer': 'Consumidor',
    'admin': 'Administrador',
    'search': 'Buscar',
    'followers': 'seguidores',
    'following': 'siguiendo',
    'submit_app': 'Enviar Aplicación',
    'manage_apps': 'Administrar Aplicaciones',
    'analytics': 'Analíticas',
    'revenue': 'Ingresos',
    'logout': 'Cerrar Sesión',
    'ai_tools': 'Herramientas de IA',
    'explore_apps': 'Explorar Aplicaciones',
    'watch_demo': 'Ver Demo',
    'try_free': 'Probar Gratis',
    'buy': 'Comprar',
    'open_app': 'Abrir Aplicación',
    'view_all': 'Ver Todas las Aplicaciones',
    'view_collection': 'Ver Colección',
    'browse_all': 'Explorar Todas las Colecciones',
    'explore': 'Explorar',
    'applications': 'aplicaciones',
    'discover_description': 'Explora las últimas aplicaciones de IA adaptadas para ti',
    'featured_description': 'Aplicaciones de IA seleccionadas que están causando sensación',
    'clear_filter': 'Borrar Filtro',
    'filtered_by': 'Filtrado por',
    'app_store_description': 'Descubre, comparte y monetiza aplicaciones de IA de vanguardia. El principal mercado para desarrolladores y entusiastas de IA independientes.',
    'category_description': 'Encuentra aplicaciones de IA adaptadas a tus necesidades específicas',
    'collection_description': 'Colecciones de aplicaciones seleccionadas para casos de uso específicos',
    'contact_support': 'Contactar Soporte',
    'purchase_history': 'Historial de Compras',
    'upgrade_plan': 'Mejorar Plan',
    'manage_subscription': 'Administrar Suscripción',
    'become_developer': 'Conviértete en Desarrollador',
    'switch_to': 'Cambiar a',
    'view_profile': 'Ver Perfil',
    'search_placeholder': 'Buscar aplicaciones de IA, desarrolladores o categorías...',
    'active_users': 'Usuarios Activos',
    'ai_apps': 'Aplicaciones IA',
    'categories_count': 'Categorías',
    'trusted_by': 'Confiado por desarrolladores en todo el mundo', 
    'platform': 'Plataforma',
    'browse_apps': 'Explorar Aplicaciones',
    'featured': 'Destacados',
    'new_releases': 'Nuevos Lanzamientos',
    'developers': 'Desarrolladores',
    'developer_portal': 'Portal de Desarrolladores',
    'api_docs': 'Documentación API',
    'guidelines': 'Directrices',
    'all_rights_reserved': 'Todos los derechos reservados.',
    'made_with': 'Hecho con',
    'by_indie_devs': 'por desarrolladores independientes',
    'no_account': "¿No tienes una cuenta?",
    'have_account': "¿Ya tienes una cuenta?",
    'terms_agreement': 'Al crear una cuenta, aceptas nuestros Términos de Servicio y Política de Privacidad.',
    'owned': 'Adquirido',
    'free': 'Gratis',
    'freemium': 'Freemium',
  },
  fr: {
    'welcome': 'Magasin d\'Applications IA',
    'featured_apps': 'Applications en Vedette',
    'discover': 'Découvrez les Applications IA',
    'categories': 'Parcourir par Catégorie',
    'collections': 'Collections Sélectionnées',
    'sign_in': 'Se Connecter',
    'sign_up': 'S\'inscrire',
    'profile': 'Profil',
    'settings': 'Paramètres',
    'developer': 'Développeur',
    'consumer': 'Consommateur',
    'admin': 'Administrateur',
    'search': 'Rechercher',
    'followers': 'abonnés',
    'following': 'abonnements',
    'submit_app': 'Soumettre une Application',
    'manage_apps': 'Gérer les Applications',
    'analytics': 'Analytiques',
    'revenue': 'Revenus',
    'logout': 'Déconnexion',
    'ai_tools': 'Outils IA',
    'explore_apps': 'Explorer les Applications',
    'watch_demo': 'Voir la Démo',
    'try_free': 'Essayer Gratuitement',
    'buy': 'Acheter',
    'open_app': 'Ouvrir l\'Application',
    'view_all': 'Voir Toutes les Applications',
    'view_collection': 'Voir la Collection',
    'browse_all': 'Parcourir Toutes les Collections',
    'explore': 'Explorer',
    'applications': 'applications',
    'discover_description': 'Explorez les dernières applications IA adaptées pour vous',
    'featured_description': 'Applications IA sélectionnées qui font des vagues',
    'clear_filter': 'Effacer le Filtre',
    'filtered_by': 'Filtré par',
    'app_store_description': 'Découvrez, partagez et monétisez des applications IA de pointe. La première place de marché pour les développeurs et les passionnés d\'IA indépendants.',
    'category_description': 'Trouvez des applications IA adaptées à vos besoins spécifiques',
    'collection_description': 'Collections d\'applications sélectionnées pour des cas d\'utilisation spécifiques',
    'contact_support': 'Contacter le Support',
    'purchase_history': 'Historique d\'Achats',
    'upgrade_plan': 'Améliorer l\'Abonnement',
    'manage_subscription': 'Gérer l\'Abonnement',
    'become_developer': 'Devenir Développeur',
    'switch_to': 'Passer à',
    'view_profile': 'Voir le Profil',
    'search_placeholder': 'Rechercher des applications IA, des développeurs ou des catégories...',
    'active_users': 'Utilisateurs Actifs',
    'ai_apps': 'Applications IA',
    'categories_count': 'Catégories',
    'trusted_by': 'Approuvé par les développeurs du monde entier', 
    'platform': 'Plateforme',
    'browse_apps': 'Parcourir les Applications',
    'featured': 'En Vedette',
    'new_releases': 'Nouvelles Sorties',
    'developers': 'Développeurs',
    'developer_portal': 'Portail Développeur',
    'api_docs': 'Documentation API',
    'guidelines': 'Directives',
    'all_rights_reserved': 'Tous droits réservés.',
    'made_with': 'Fait avec',
    'by_indie_devs': 'par des développeurs indépendants',
    'no_account': "Vous n'avez pas de compte?",
    'have_account': "Vous avez déjà un compte?",
    'terms_agreement': 'En créant un compte, vous acceptez nos Conditions de Service et notre Politique de Confidentialité.',
    'owned': 'Possédé',
    'free': 'Gratuit',
    'freemium': 'Freemium',
  },
  de: {
    'welcome': 'KI-App-Store',
    'featured_apps': 'Ausgewählte Anwendungen',
    'discover': 'Entdecke KI-Anwendungen',
    'categories': 'Nach Kategorie durchsuchen',
    'collections': 'Kuratierte Sammlungen',
    'sign_in': 'Anmelden',
    'sign_up': 'Registrieren',
    'profile': 'Profil',
    'settings': 'Einstellungen',
    'developer': 'Entwickler',
    'consumer': 'Verbraucher',
    'admin': 'Administrator',
    'search': 'Suchen',
    'followers': 'Follower',
    'following': 'Folgt',
    'submit_app': 'Anwendung einreichen',
    'manage_apps': 'Anwendungen verwalten',
    'analytics': 'Analysen',
    'revenue': 'Einnahmen',
    'logout': 'Abmelden',
    'ai_tools': 'KI-Werkzeuge',
    'explore_apps': 'Apps Erkunden',
    'watch_demo': 'Demo Ansehen',
    'try_free': 'Kostenlos Testen',
    'buy': 'Kaufen',
    'open_app': 'App Öffnen',
    'view_all': 'Alle Apps Anzeigen',
    'view_collection': 'Sammlung Anzeigen',
    'browse_all': 'Alle Sammlungen Durchsuchen',
    'explore': 'Erkunden',
    'applications': 'Anwendungen',
    'discover_description': 'Entdecken Sie die neuesten KI-Anwendungen, die auf Sie zugeschnitten sind',
    'featured_description': 'Handverlesene KI-Anwendungen, die Wellen schlagen',
    'clear_filter': 'Filter Löschen',
    'filtered_by': 'Gefiltert nach',
    'app_store_description': 'Entdecken, teilen und monetarisieren Sie modernste KI-Anwendungen. Der führende Marktplatz für unabhängige KI-Entwickler und Enthusiasten.',
    'category_description': 'Finden Sie KI-Apps, die auf Ihre spezifischen Bedürfnisse zugeschnitten sind',
    'collection_description': 'Handverlesene App-Sammlungen für spezifische Anwendungsfälle',
    'contact_support': 'Support Kontaktieren',
    'purchase_history': 'Kaufverlauf',
    'upgrade_plan': 'Plan Upgraden',
    'manage_subscription': 'Abonnement Verwalten',
    'become_developer': 'Entwickler Werden',
    'switch_to': 'Wechseln zu',
    'view_profile': 'Profil Anzeigen',
    'search_placeholder': 'KI-Apps, Entwickler oder Kategorien suchen...',
    'active_users': 'Aktive Benutzer',
    'ai_apps': 'KI-Apps',
    'categories_count': 'Kategorien',
    'trusted_by': 'Vertraut von Entwicklern weltweit', 
    'platform': 'Plattform',
    'browse_apps': 'Apps Durchsuchen',
    'featured': 'Ausgewählt',
    'new_releases': 'Neuerscheinungen',
    'developers': 'Entwickler',
    'developer_portal': 'Entwicklerportal',
    'api_docs': 'API-Dokumentation',
    'guidelines': 'Richtlinien',
    'all_rights_reserved': 'Alle Rechte vorbehalten.',
    'made_with': 'Gemacht mit',
    'by_indie_devs': 'von unabhängigen Entwicklern',
    'no_account': "Haben Sie kein Konto?",
    'have_account': "Haben Sie bereits ein Konto?",
    'terms_agreement': 'Durch die Erstellung eines Kontos stimmen Sie unseren Nutzungsbedingungen und Datenschutzrichtlinien zu.',
    'owned': 'Besessen',
    'free': 'Kostenlos',
    'freemium': 'Freemium',
  },
  ja: {
    'welcome': 'AIアプリストア',
    'featured_apps': '注目のアプリ',
    'discover': 'AIアプリを発見する',
    'categories': 'カテゴリーで閲覧',
    'collections': 'キュレーションされたコレクション',
    'sign_in': 'サインイン',
    'sign_up': '登録',
    'profile': 'プロフィール',
    'settings': '設定',
    'developer': '開発者',
    'consumer': '消費者',
    'admin': '管理者',
    'search': '検索',
    'followers': 'フォロワー',
    'following': 'フォロー中',
    'submit_app': 'アプリを提出',
    'manage_apps': 'アプリを管理',
    'analytics': '分析',
    'revenue': '収益',
    'logout': 'サインアウト',
    'ai_tools': 'AIツール',
    'explore_apps': 'アプリを探索',
    'watch_demo': 'デモを見る',
    'try_free': '無料で試す',
    'buy': '購入',
    'open_app': 'アプリを開く',
    'view_all': 'すべてのアプリを見る',
    'view_collection': 'コレクションを見る',
    'browse_all': 'すべてのコレクションを閲覧',
    'explore': '探索',
    'applications': 'アプリケーション',
    'discover_description': 'あなたに合わせた最新のAIアプリケーションを探索',
    'featured_description': '注目を集めている厳選されたAIアプリケーション',
    'clear_filter': 'フィルターをクリア',
    'filtered_by': 'フィルター条件',
    'app_store_description': '最先端のAIアプリケーションを発見、共有、収益化。インディーAI開発者と愛好家のための一流のマーケットプレイス。',
    'category_description': 'あなたの特定のニーズに合わせたAIアプリを見つける',
    'collection_description': '特定のユースケース向けに厳選されたアプリコレクション',
    'contact_support': 'サポートに連絡',
    'purchase_history': '購入履歴',
    'upgrade_plan': 'プランをアップグレード',
    'manage_subscription': 'サブスクリプションを管理',
    'become_developer': '開発者になる',
    'switch_to': '切り替える',
    'view_profile': 'プロフィールを見る',
    'search_placeholder': 'AIアプリ、開発者、またはカテゴリを検索...',
    'active_users': 'アクティブユーザー',
    'ai_apps': 'AIアプリ',
    'categories_count': 'カテゴリー',
    'trusted_by': '世界中の開発者に信頼されています', 
    'platform': 'プラットフォーム',
    'browse_apps': 'アプリを閲覧',
    'featured': '注目',
    'new_releases': '新着',
    'developers': '開発者',
    'developer_portal': '開発者ポータル',
    'api_docs': 'APIドキュメント',
    'guidelines': 'ガイドライン',
    'all_rights_reserved': '全著作権所有。',
    'made_with': '制作',
    'by_indie_devs': 'インディー開発者による',
    'no_account': "アカウントをお持ちでないですか？",
    'have_account': "すでにアカウントをお持ちですか？",
    'terms_agreement': 'アカウントを作成することで、利用規約とプライバシーポリシーに同意したことになります。',
    'owned': '所有済み',
    'free': '無料',
    'freemium': 'フリーミアム',
  },
  zh: {
    'welcome': 'AI应用商店',
    'featured_apps': '精选应用',
    'discover': '发现AI应用',
    'categories': '按类别浏览',
    'collections': '精心策划的集合',
    'sign_in': '登录',
    'sign_up': '注册',
    'profile': '个人资料',
    'settings': '设置',
    'developer': '开发者',
    'consumer': '消费者',
    'admin': '管理员',
    'search': '搜索',
    'followers': '粉丝',
    'following': '关注',
    'submit_app': '提交应用',
    'manage_apps': '管理应用',
    'analytics': '分析',
    'revenue': '收入',
    'logout': '退出登录',
    'ai_tools': 'AI工具',
    'explore_apps': '探索应用',
    'watch_demo': '观看演示',
    'try_free': '免费试用',
    'buy': '购买',
    'open_app': '打开应用',
    'view_all': '查看所有应用',
    'view_collection': '查看集合',
    'browse_all': '浏览所有集合',
    'explore': '探索',
    'applications': '应用',
    'discover_description': '探索为您量身定制的最新AI应用',
    'featured_description': '精心挑选的引起轰动的AI应用',
    'clear_filter': '清除筛选',
    'filtered_by': '筛选条件',
    'app_store_description': '发现、分享和变现尖端AI应用。独立AI开发者和爱好者的首选市场。',
    'category_description': '找到适合您特定需求的AI应用',
    'collection_description': '为特定用例精心策划的应用集合',
    'contact_support': '联系支持',
    'purchase_history': '购买历史',
    'upgrade_plan': '升级计划',
    'manage_subscription': '管理订阅',
    'become_developer': '成为开发者',
    'switch_to': '切换到',
    'view_profile': '查看个人资料',
    'search_placeholder': '搜索AI应用、开发者或类别...',
    'active_users': '活跃用户',
    'ai_apps': 'AI应用',
    'categories_count': '类别',
    'trusted_by': '全球开发者信赖', 
    'platform': '平台',
    'browse_apps': '浏览应用',
    'featured': '精选',
    'new_releases': '新发布',
    'developers': '开发者',
    'developer_portal': '开发者门户',
    'api_docs': 'API文档',
    'guidelines': '指南',
    'all_rights_reserved': '版权所有。',
    'made_with': '由',
    'by_indie_devs': '独立开发者制作',
    'no_account': "没有账户？",
    'have_account': "已有账户？",
    'terms_agreement': '创建账户即表示您同意我们的服务条款和隐私政策。',
    'owned': '已拥有',
    'free': '免费',
    'freemium': '免费增值',
  },
};

// Provider component
export const TranslationProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState(() => {
    // Get language from localStorage or URL params or default to 'en'
    const savedLanguage = localStorage.getItem('preferredLanguage');
    const urlParams = new URLSearchParams(window.location.search);
    const langParam = urlParams.get('lang');
    return langParam || savedLanguage || 'en';
  });

  // Function to translate a key
  const t = (key: string): string => {
    if (!translations[language]) {
      return key;
    }
    return translations[language][key] || translations['en'][key] || key;
  };

  // Update document language attribute
  useEffect(() => {
    document.documentElement.lang = language;
  }, [language]);

  return (
    <TranslationContext.Provider value={{ language, t, setLanguage }}>
      {children}
    </TranslationContext.Provider>
  );
};

// Hook to use translations
export const useTranslation = () => {
  const context = useContext(TranslationContext);
  if (!context) {
    throw new Error('useTranslation must be used within a TranslationProvider');
  }
  return context;
};